<?xml version="1.0"?>
<openerp>
<data>

    <record id="mrp_production_form_view" model="ir.ui.view">
        <field name="name">mrp.production.form</field>
        <field name="model">mrp.production</field>
        <field name="inherit_id" ref="mrp.mrp_production_form_view"/>
        <field name="arch" type="xml">
            <!-- MO overview -->
            <xpath expr="//sheet/group" position="inside">
                <group>
                    <field name="account_routing_id" options="{'create': false, 'create_edit': false}" widget="selection"
                            domain="[('section_ids','in',[%(imsar_mrp.ar_section_mrp)d])]"/>
                    <field name="routing_line_id" options="{'create': false, 'create_edit': false}" widget="selection"
                            domain="[('routing_id','=',account_routing_id),('section_ids','in',[%(imsar_mrp.ar_section_mrp)d])]"/>
                    <field name="routing_subrouting_id" options="{'create': false, 'create_edit': false}" widget="selection"
                            domain="[('routing_line_id','=',routing_line_id),('type','!=','view')]" />
                </group>
            </xpath>
            <!-- Products Consumed -->
            <xpath expr="//sheet/notebook//page[@string='Consumed Products']" position="replace">
                <page string="Consumed Products">
                    <group col="3">
                        <group string="Products to Consume">
                            <field name="move_lines" nolabel="1" options="{'reload_on_button': true}">
                                <tree colors="blue:state == 'draft';black:state in ('ready','assigned','in_production');gray:state in ('cancel','done');red:state in ('confirmed','waiting')" string="Products to Consume">
                                    <field name="product_id"/>
                                    <field name="product_uom_qty"  string="Quantity"/>
                                    <field name="restrict_lot_id" context="{'product_id': product_id}" groups="stock.group_production_lot"/>
                                    <field name="product_uom" string="Unit of Measure" groups="product.group_uom" invisible="1"/>
                                    <field name="state" invisible="1"/>
                                </tree>
                            </field>
                        </group>
                        <group string="Consumed Products">
                            <field name="move_lines2" nolabel="1" options="{'reload_on_button': true}">
                                <tree colors="red:scrapped==True;blue:state == 'draft';black:state in ('confirmed','ready','in_production');gray:state == 'cancel' " string="Consumed Products" editable="bottom">
                                    <field name="product_id" readonly="1"/>
                                    <field name="restrict_lot_id" context="{'product_id': product_id}" groups="stock.group_production_lot"/>
                                    <field name="product_uom_qty" readonly="1"/>
                                    <field name="product_uom" readonly="1" string="Unit of Measure" groups="product.group_uom" invisible="1"/>
                                    <field name="state" invisible="1"/>
                                    <field name="scrapped" invisible="1"/>
                                </tree>
                            </field>
                        </group>
                    </group>
                </page>
            </xpath>
            <!-- Finished Products -->
            <xpath expr="//sheet/notebook//field[@name='move_created_ids']//field[@name='product_uom_qty']" position="after">
                <field name="restrict_lot_id" groups="stock.group_production_lot"/>
            </xpath>
            <xpath expr="//sheet/notebook//field[@name='move_created_ids']//field[@name='product_uom']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//sheet/notebook//field[@name='move_created_ids2']//field[@name='product_uom']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
        </field>
    </record>


    <record id="view_mrp_product_produce_wizard" model="ir.ui.view">
        <field name="name">mrp.product.produce.form</field>
        <field name="model">mrp.product.produce</field>
        <field name="inherit_id" ref="mrp.view_mrp_product_produce_wizard"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='lot_id']" position="replace">
                <field name="lot_ids" widget="many2many_tags" domain="[('product_id', '=', product_id)]"/>
            </xpath>
            <xpath expr="//field[@name='product_qty']" position="attributes">
                <attribute name="readonly">1</attribute>
                <attribute name="string">"Quantity"</attribute>
            </xpath>
        </field>
    </record>

</data>
</openerp>
